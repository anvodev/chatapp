<!DOCTYPE html>
<html lang="en">
<head>
    <title>Chat App with Go</title>
    </head>
    <body>
        <div class="center">
            <h1>Chat App with Go</h1>
            <h2 id="chat-header">
                Currently in chat:
                <span id="currentChatroom">general</span>
            </h2>
            <form action="" id="chatroom-selection">
                <label for="chatroom">Choose a chatroom:</label>
                <select name="chatroom" id="chatroom">
                    <option value="general">general</option>
                    <option value="random">random</option>
                </select>
                <input type="submit" value="Change chatroom">
            </form>

            <br>

            <textarea id="messages" cols="100" rows="20"></textarea>

            <br>

            <form action="" id="message-form">
                <input type="text" id="message-input">
                <input type="submit" value="Send">
            </form>

            <script>
                var selectedChat = 'general';

                function updateChatroom() {
                    var chatroom = document.getElementById('chatroom');
                    var newChatroom = chatroom.value;
                    selectedChat = newChatroom;
                    document.getElementById('currentChatroom').innerHTML = selectedChat;
                    document.getElementById('chatroom-selection').reset();
                }

                function addMessage(message) {
                    var messages = document.getElementById('messages');
                    messages.value += message + '\n';
                }

                window.onload = function() {
                    document.getElementById('chatroom-selection').addEventListener('submit', function(event) {
                        event.preventDefault();
                        updateChatroom();
                    });

                    if (window["WebSocket"]) {
                        console.log("WebSocket is supported by your Browser!");

                        var socket = new WebSocket("ws://localhost:8080/ws");
                        socket.onmessage = function(event) {
                            addMessage(event.data);
                        }
                    } else {
                        console.log("WebSocket NOT supported by your Browser!");
                    }
                }
            </script>
            <style>
                body {
                    font-family: sans-serif;
                    background-color: #f0f0f0;
                    padding: 20px;

                }
                .center {
                    text-align: center;
                }
            </style>
        </div>
    </body>
</html>